"use strict";(self.webpackChunkmidjourney_proxy_admin=self.webpackChunkmidjourney_proxy_admin||[]).push([[903],{39936:function(nt,xe,o){o.r(xe),o.d(xe,{default:function(){return Da}});var wa=o(97857),j=o.n(wa),Ca=o(15009),x=o.n(Ca),ya=o(64599),K=o.n(ya),ja=o(19632),Ta=o.n(ja),Ia=o(99289),z=o.n(Ia),xa=o(5574),g=o.n(xa),M=o(66927),Ma=o(18429),Pa=o(51042),Me=o(52645),Aa=o(90930),Za=o(94272),W=o(55102),ne=o(4393),Ea=o(16568),b=o(2453),A=o(83622),Fa=o(68997),L=o(86250),q=o(42075),Ra=o(66309),ka=o(58073),Pe=o(74330),Ua=o(38703),N=o(66476),Ae=o(78045),de=o(74656),Ba=o(28248),p=o(67294),Ze=o(30538),ce={cardTitleTime:"cardTitleTime___ULudn",taskErrorTip:"taskErrorTip___EJ9yV"},a=o(85893),ie=W.Z.TextArea,La=ne.Z.Meta,Oa=function(){var Na=Ea.ZP.useNotification(),Ee=g()(Na,2),R=Ee[0],Ja=Ee[1],Wa=(0,p.useState)([]),Fe=g()(Wa,2),Ha=Fe[0],Re=Fe[1],Va=(0,p.useState)(!1),ke=g()(Va,2),Ga=ke[0],Ue=ke[1],za=(0,p.useState)("imagine"),Be=g()(za,2),C=Be[0],Ya=Be[1],$a=(0,p.useState)("MID_JOURNEY"),Le=g()($a,2),T=Le[0],Xa=Le[1],Qa=(0,p.useState)(""),Oe=g()(Qa,2),E=Oe[0],H=Oe[1],Ka=(0,p.useState)("SQUARE"),De=g()(Ka,2),Ne=De[0],qa=De[1],_a=(0,p.useState)([]),Je=g()(_a,2),O=Je[0],V=Je[1],er=(0,p.useState)("relax"),We=g()(er,2),pe=We[0],ar=We[1],rr=(0,p.useState)([]),He=g()(rr,2),Ve=He[0],tr=He[1],sr=(0,p.useState)(!1),Ge=g()(sr,2),lt=Ge[0],ot=Ge[1],nr=(0,p.useState)([]),ze=g()(nr,2),k=ze[0],_=ze[1],ir=(0,p.useState)([]),Ye=g()(ir,2),U=Ye[0],ee=Ye[1],lr=(0,p.useState)(""),$e=g()(lr,2),or=$e[0],ge=$e[1],ur=(0,p.useState)(!1),Xe=g()(ur,2),J=Xe[0],P=Xe[1],dr=(0,p.useState)(new Set),cr=g()(dr,1),y=cr[0],pr=(0,p.useState)(!1),Qe=g()(pr,2),gr=Qe[0],Y=Qe[1],fr=(0,p.useState)(""),Ke=g()(fr,2),mr=Ke[0],vr=Ke[1],hr=(0,p.useState)(""),qe=g()(hr,2),le=qe[0],_e=qe[1],Sr=(0,p.useState)(""),ea=g()(Sr,2),fe=ea[0],br=ea[1],wr=(0,p.useState)(""),aa=g()(wr,2),oe=aa[0],ra=aa[1],Cr=(0,p.useState)(0),ta=g()(Cr,2),sa=ta[0],yr=ta[1],jr=(0,p.useState)(!1),na=g()(jr,2),me=na[0],Tr=na[1],Ir=(0,p.useState)(!1),ia=g()(Ir,2),xr=ia[0],la=ia[1],Mr=(0,p.useState)([]),oa=g()(Mr,2),ua=oa[0],Pr=oa[1],Ar=(0,p.useState)(),da=g()(Ar,2),ae=da[0],ut=da[1],Zr=(0,p.useState)(""),ca=g()(Zr,2),Er=ca[0],Fr=ca[1],Rr=(0,p.useState)({}),pa=g()(Rr,2),ve=pa[0],kr=pa[1],l=(0,Za.useIntl)(),he=(0,p.useRef)([]),$=(0,p.useRef)(null),D="midjourney-proxy-admin",Se=sessionStorage.getItem("mj-image-prefix")||"";(0,p.useEffect)(function(){return Lr({state:D,pageNumber:0,pageSize:3,statusSet:["NOT_START","SUBMITTED","IN_PROGRESS","FAILURE","SUCCESS"],sort:"submitTime,desc"}),$.current&&clearInterval($.current),$.current=setInterval(function(){y.size!==0&&Ur()},2e3),function(){$.current&&(clearInterval($.current),$.current=null)}},[]);var Ur=function(){var n=z()(x()().mark(function e(){var r,i,s,m,u,d,v,I,f,h,S;return x()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return r=Array.from(y),i=new Set(r),w.next=4,(0,M.BX)(r);case 4:s=w.sent,m=!1,u=Ta()(he.current),d=K()(s),w.prev=8,I=x()().mark(function Q(){var Z,se;return x()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:Z=v.value,i.delete(Z.id),(Z.status==="FAILURE"||Z.status==="SUCCESS"||Z.status==="CANCEL")&&y.delete(Z.id),se=u.find(function(B){return B.id===Z.id}),se?Br(se,Z)||(m=!0,u.splice(u.indexOf(se),1,Z)):(m=!0,u.push(Z));case 5:case"end":return c.stop()}},Q)}),d.s();case 11:if((v=d.n()).done){w.next=15;break}return w.delegateYield(I(),"t0",13);case 13:w.next=11;break;case 15:w.next=20;break;case 17:w.prev=17,w.t1=w.catch(8),d.e(w.t1);case 20:return w.prev=20,d.f(),w.finish(20);case 23:f=K()(i);try{for(f.s();!(h=f.n()).done;)S=h.value,y.delete(S)}catch(Q){f.e(Q)}finally{f.f()}m&&(he.current=u,Re(u),ga());case 26:case"end":return w.stop()}},e,null,[[8,17,20,23]])}));return function(){return n.apply(this,arguments)}}(),Br=function(e,r){return e.status===r.status&&e.progress===r.progress&&e.imageUrl===r.imageUrl},ga=function(){setTimeout(function(){var e=document.getElementById("task-panel");e&&e.scrollTo(0,e.scrollHeight)},20)},Lr=function(){var n=z()(x()().mark(function e(r){var i,s,m,u,d,v;return x()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return Ue(!0),f.next=3,(0,M.Ed)();case 3:return i=f.sent,Pr(i),f.next=7,(0,M.Pn)(r);case 7:s=f.sent,m=s.list.reverse(),u=K()(m);try{for(u.s();!(d=u.n()).done;)v=d.value,v.status!=="FAILURE"&&v.status!=="SUCCESS"&&v.action!=="CANCEL"&&y.add(v.id)}catch(h){u.e(h)}finally{u.f()}he.current=m,Re(m),Ue(!1),ga();case 15:case"end":return f.stop()}},e)}));return function(r){return n.apply(this,arguments)}}(),Or=function(e){Ya(e),H(""),V([])},Dr=function(e){Fr(e);var r=ua.find(function(s){return s.channelId===e});if(r){var i=r.allowModes||[];tr(i)}},Nr=function(e){var r=e.target.value;Xa(r),H(""),V([])},Jr=function(e){var r=e.target.value;qa(r)},ue=function(e){H(e.target.value)},fa=function(e){_e(e.target.value)},Wr=function(e){if(Ve.length>0&&e!=="default"&&!Ve.includes(e)){b.ZP.warning(l.formatMessage({id:"pages.draw.speedMode.notAllowed"}));return}ar(e)},X=function(){var n=z()(x()().mark(function e(r){return x()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,new Promise(function(m){var u=new FileReader;u.onload=function(){return m(u.result)},u.readAsDataURL(r)});case 2:return s.abrupt("return",s.sent);case 3:case"end":return s.stop()}},e)}));return function(r){return n.apply(this,arguments)}}(),F=function(){var n=z()(x()().mark(function e(){var r,i,s,m,u,d,v,I,f,h,S,te,w,Q,Z;return x()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(T==="INSIGHT_FACE"||T==="FACE_SWAP")){t.next=26;break}if(!(k.length<1)){t.next=4;break}return b.ZP.error(l.formatMessage({id:"pages.draw.swapTip"})),t.abrupt("return");case 4:if(!(U.length<1)){t.next=7;break}return b.ZP.error(l.formatMessage({id:"pages.draw.swapTip"})),t.abrupt("return");case 7:if(P(!0),r={sourceUrl:"",targetUrl:"",sourceBase64:"",targetBase64:"",state:D},!k[0].originFileObj){t.next=15;break}return t.next=12,X(k[0].originFileObj);case 12:r.sourceBase64=t.sent,t.next=16;break;case 15:r.sourceUrl=k[0].name;case 16:if(!U[0].originFileObj){t.next=22;break}return t.next=19,X(U[0].originFileObj);case 19:r.targetBase64=t.sent,t.next=23;break;case 22:r.targetUrl=U[0].name;case 23:(0,M.Vl)(r).then(function(c){P(!1),c.code===22||c.code===1?(c.code===22?R.warning({message:"warn",description:c.description}):b.ZP.success(l.formatMessage({id:"pages.draw.submitSuccess"})),y.add(c.result),_([]),ee([])):R.error({message:"error",description:c.description})}),t.next=146;break;case 26:if(T!=="VIDEO_FACE_SWAP"){t.next=51;break}if(!(k.length<1)){t.next=30;break}return b.ZP.error(l.formatMessage({id:"pages.draw.swapTip"})),t.abrupt("return");case 30:if(!(U.length<1)){t.next=33;break}return b.ZP.error(l.formatMessage({id:"pages.draw.swapTip"})),t.abrupt("return");case 33:if(P(!0),i={sourceUrl:"",targetUrl:"",sourceBase64:"",targetBase64:"",state:D},!k[0].originFileObj){t.next=41;break}return t.next=38,X(k[0].originFileObj);case 38:i.sourceBase64=t.sent,t.next=42;break;case 41:i.sourceUrl=k[0].name;case 42:s=new FormData,U[0].originFileObj?s.append("TargetFile",U[0].originFileObj):i.targetUrl=U[0].name,s.append("SourceBase64",i.sourceBase64||""),s.append("SourceUrl",i.sourceUrl||""),s.append("TargetUrl",i.targetUrl||""),s.append("Satate",i.state),(0,M.Wv)(s,{headers:{"Content-Type":"multipart/form-data"}}).then(function(c){P(!1),c.code===22||c.code===1?(c.code===22?R.warning({message:"warn",description:c.description}):b.ZP.success(l.formatMessage({id:"pages.draw.submitSuccess"})),y.add(c.result),_([]),ee([])):R.error({message:"error",description:c.description})}),t.next=146;break;case 51:if(C!=="show"){t.next=59;break}if(E){t.next=55;break}return b.ZP.error(l.formatMessage({id:"pages.draw.taskIdNotBlank"})),t.abrupt("return");case 55:y.add(E),H(""),t.next=146;break;case 59:if(C!=="showjobid"){t.next=67;break}if(E){t.next=63;break}return b.ZP.error(l.formatMessage({id:"pages.draw.promptNotBlank"})),t.abrupt("return");case 63:P(!0),(0,M.cq)("show",{botType:T,jobId:E,state:D,accountFilter:{instanceId:ae}}).then(function(c){P(!1);var B=re(c);B&&(y.add(c.result),H(""),V([]))}),t.next=146;break;case 67:if(C!=="imagine"){t.next=98;break}if(E){t.next=71;break}return b.ZP.error(l.formatMessage({id:"pages.draw.promptNotBlank"})),t.abrupt("return");case 71:P(!0),m=[],u=K()(O),t.prev=74,u.s();case 76:if((d=u.n()).done){t.next=84;break}return v=d.value,t.next=80,X(v.originFileObj);case 80:I=t.sent,m.push(I);case 82:t.next=76;break;case 84:t.next=89;break;case 86:t.prev=86,t.t0=t.catch(74),u.e(t.t0);case 89:return t.prev=89,u.f(),t.finish(89);case 92:f=E,f=f.replace(/\s*(--fast|--turbo|--relax)\s*/g," ").trim(),pe?f="".concat(f," --").concat(pe):f="".concat(f," --relax"),(0,M.qJ)(C,{botType:T,prompt:f,base64Array:m,state:D,accountFilter:{instanceId:ae}}).then(function(c){P(!1);var B=re(c);B&&(y.add(c.result),H(""),V([]))}),t.next=146;break;case 98:if(C!=="blend"){t.next=126;break}if(!(O.length<2)){t.next=102;break}return b.ZP.error(l.formatMessage({id:"pages.draw.blendTip"})),t.abrupt("return");case 102:P(!0),h=[],S=K()(O),t.prev=105,S.s();case 107:if((te=S.n()).done){t.next=115;break}return w=te.value,t.next=111,X(w.originFileObj);case 111:Q=t.sent,h.push(Q);case 113:t.next=107;break;case 115:t.next=120;break;case 117:t.prev=117,t.t1=t.catch(105),S.e(t.t1);case 120:return t.prev=120,S.f(),t.finish(120);case 123:(0,M.qJ)(C,{botType:T,base64Array:h,dimensions:Ne,state:D,accountFilter:{instanceId:ae}}).then(function(c){P(!1);var B=re(c);B&&(y.add(c.result),V([]))}),t.next=146;break;case 126:if(C!=="describe"){t.next=137;break}if(!(O.length<1)){t.next=130;break}return b.ZP.error(l.formatMessage({id:"pages.draw.imageEmptyTip"})),t.abrupt("return");case 130:return P(!0),t.next=133,X(O[0].originFileObj);case 133:Z=t.sent,(0,M.qJ)(C,{botType:T,base64:Z,state:D,accountFilter:{instanceId:ae}}).then(function(c){P(!1);var B=re(c);B&&(y.add(c.result),V([]))}),t.next=146;break;case 137:if(C!=="shorten"){t.next=145;break}if(E){t.next=141;break}return b.ZP.error(l.formatMessage({id:"pages.draw.promptNotBlank"})),t.abrupt("return");case 141:P(!0),(0,M.qJ)(C,{botType:T,prompt:E,state:D,accountFilter:{instanceId:ae}}).then(function(c){P(!1);var B=re(c);B&&(y.add(c.result),H(""))}),t.next=146;break;case 145:b.ZP.error(l.formatMessage({id:"pages.draw.unsupportedAction"}));case 146:case"end":return t.stop()}},e,null,[[74,86,89,92],[105,117,120,123]])}));return function(){return n.apply(this,arguments)}}(),re=function(e){return e.code===22||e.code===1?(e.code===22?R.warning({message:"warn",description:e.description}):b.ZP.success(l.formatMessage({id:"pages.draw.submitSuccess"})),!0):(R.error({message:"error",description:e.description}),!1)},Hr=function(e,r){var i=r.customId,s=e.id,m="".concat(r.emoji," ").concat(r.label);ge("".concat(s,":").concat(i));var u=ve[s];(0,M.qJ)("action",{taskId:s,customId:i,state:D,chooseSameChannel:!0,accountFilter:{remix:u}}).then(function(d){if(ge(""),d.code===22)R.warning({message:"warn",description:d.description}),r.style=3,y.add(d.result);else if(d.code===21){if(r.style=3,vr("".concat(d.result," ").concat(m)),br(d.result),_e(d.properties.finalPrompt),Tr(u),i.startsWith("MJ::Inpaint:")){var v="".concat(Se).concat(e.imageUrl),I=new Image;I.src=v,I.onload=function(){yr(Math.floor(550/I.width*I.height)),ra(v),Y(!0),setTimeout(function(){Vr()},300)}}else ra(""),Y(!0);Y(!0)}else if(d.code===1){if(r.style=3,d.result){var f=d.result.split(",");f.forEach(function(h){y.add(h)})}b.ZP.success(l.formatMessage({id:"pages.draw.actionSuccess"}))}else R.error({message:"error",description:d.description})}).catch(function(d){ge(""),R.error({message:"error",description:d.message||"\u64CD\u4F5C\u5931\u8D25"})})},be=!1,we=0,Ce=0,Vr=function(){var e=document.getElementById("canvas");e.width=e.clientWidth,e.height=e.clientHeight;var r=e.getBoundingClientRect(),i=Math.floor(r.left),s=Math.floor(r.top),m=e.getContext("2d");m.fillStyle="blue",e.onmousedown=function(u){we=u.clientX,Ce=u.clientY,be=!0},e.onmousemove=function(u){be===!0&&m.fillRect(we-i,Ce-s,u.clientX-we,u.clientY-Ce)},e.onmouseup=function(){be=!1}},Gr=function(){(0,M.el)(fe),Y(!1)},zr=function(){var n=z()(x()().mark(function e(){var r,i,s,m;return x()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(la(!0),!oe){d.next=11;break}return i=document.getElementById("canvas"),s=new Image,s.src=i.toDataURL("image/png"),d.next=7,Yr(s);case 7:m=d.sent,r={maskBase64:m,taskId:fe,prompt:le,remix:me},d.next=12;break;case 11:r={taskId:fe,prompt:le,remix:me};case 12:(0,M.qJ)("modal",r).then(function(v){la(!1),v.code===22?(R.warning({message:"warn",description:v.description}),y.add(v.result),Y(!1)):v.code===1?(y.add(v.result),Y(!1),b.ZP.success(l.formatMessage({id:"pages.draw.subSuccess"}))):R.error({message:"error",description:v.description})});case 13:case"end":return d.stop()}},e)}));return function(){return n.apply(this,arguments)}}(),Yr=function(){var n=z()(x()().mark(function e(r){return x()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,new Promise(function(m){r.onload=function(){var u=r.width,d=r.height,v=document.createElement("canvas"),I=v.getContext("2d");v.width=u,v.height=d,I.drawImage(r,0,0,u,d);for(var f=I.getImageData(0,0,u,d),h=f.data,S=0;S<h.length;S+=4)h[S]!==0||h[S+1]!==0||h[S+2]!==0?(h[S]=parseInt("0xff"),h[S+1]=parseInt("0xff"),h[S+2]=parseInt("0xff")):(h[S]=0,h[S+1]=0,h[S+2]=0,h[S+3]=255);I.putImageData(f,0,0);var te=v.toDataURL("png");m(te)}});case 2:return s.abrupt("return",s.sent);case 3:case"end":return s.stop()}},e)}));return function(r){return n.apply(this,arguments)}}(),$r=function(e){var r="Midjourney - ".concat(e.displays.discordInstanceId);return e.botType==="NIJI_JOURNEY"?r="niji\u30FBjourney - ".concat(e.displays.discordInstanceId):(e.botType==="INSIGHT_FACE"||e.botType==="FACE_SWAP")&&(r="InsightFaceSwap - ".concat(e.displays.discordInstanceId)),e.status!=="SUCCESS"&&e.status!=="FAILURE"&&e.status!=="CANCEL"&&e.action!=="SWAP_FACE"?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:r}),(0,a.jsx)("span",{className:ce.cardTitleTime,children:e.displays.submitTime}),(0,a.jsx)(A.ZP,{style:{marginLeft:"10px"},type:"link",shape:"circle",icon:(0,a.jsx)(Ma.Z,{}),onClick:function(){return(0,M.el)(e.id)}})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:r}),(0,a.jsx)("span",{className:ce.cardTitleTime,children:e.displays.submitTime})]})},Xr=function(e){var r=e.description,i=e.properties.messageContent;return i&&(r=i.replace(/<@[^>]+>/g,"")),(0,a.jsx)(Ze.UG,{children:r})},Qr=function(){return Ha.map(function(e){var r="./midjourney.webp";return e.botType==="NIJI_JOURNEY"?r="./niji.webp":(e.botType==="INSIGHT_FACE"||e.botType==="FACE_SWAP"||e.botType==="VIDEO_FACE_SWAP")&&(r="./insightface.webp"),(0,a.jsxs)(ne.Z,{bordered:!1,bodyStyle:{backgroundColor:"#eaeaea",marginBottom:"10px"},children:[(0,a.jsx)(La,{avatar:(0,a.jsx)(Fa.Z,{src:r}),title:$r(e),description:Xr(e)}),(0,a.jsxs)(L.Z,{vertical:!0,style:{paddingLeft:"48px"},children:[at(e),(0,a.jsx)(q.Z,{wrap:!0,style:{marginTop:"7px"},children:et(e)})]})]},e.id)})},ma=function(e){if(!e.properties.finalPrompt)return(0,a.jsx)(a.Fragment,{});var r=e.properties.finalPrompt;return(0,a.jsx)(Ze.UG,{children:r.replace(new RegExp("(?<!\\n)\\n","g"),`

`)})},ye=function(e){if(e.status==="FAILURE")return(0,a.jsx)("span",{className:ce.taskErrorTip,children:e.failReason});if(e.status==="SUCCESS")return(0,a.jsx)(a.Fragment,{});if(e.status==="IN_PROGRESS")return(0,a.jsx)(a.Fragment,{children:qr(e)});var r="purple";return e.status==="SUBMITTED"?r="lime":e.status==="CANCEL"?r="magenta":e.status==="MODAL"&&(r="warning"),(0,a.jsx)("span",{children:(0,a.jsx)(Ra.Z,{color:r,children:e.displays.status})})},va=function(e,r){return e?(0,a.jsx)(ka.Z,{width:r,src:"".concat(Se).concat(e),placeholder:(0,a.jsx)(Pe.Z,{tip:"Loading",size:"large"})}):(0,a.jsx)(a.Fragment,{})},Kr=function(e,r){return e?(0,a.jsx)("div",{children:(0,a.jsx)(Pe.Z,{tip:"Loading",size:"large",children:(0,a.jsx)("div",{style:{minHeight:"100px"},children:(0,a.jsx)("video",{width:r,controls:!0,src:Se+e})})})}):(0,a.jsx)(a.Fragment,{})},qr=function(e){var r=e.progress,i=0;return r&&r.indexOf("%")>0&&(i=parseInt(r.substring(0,r.indexOf("%")))),(0,a.jsx)("span",{style:{width:250},children:(0,a.jsx)(Ua.Z,{percent:i,status:"normal"})})},_r=function(e){kr(function(r){var i=j()({},r);return i[e]=!r[e],i})},et=function(e){var r=e.buttons.map(function(s){return(0,a.jsxs)(A.ZP,{ghost:!0,style:{backgroundColor:s.style===3?"#258146":"rgb(131 133 142)"},onClick:function(){Hr(e,s)},loading:or==="".concat(e.id,":").concat(s.customId),children:[s.emoji," ",s.label]},"".concat(e.id,":").concat(s.customId))});if(e.buttons&&e.buttons.length>0){var i=(0,a.jsxs)(A.ZP,{ghost:!0,style:{backgroundColor:ve[e.id]?"#258146":"rgb(131 133 142)"},onClick:function(){return _r(e.id)},icon:(0,a.jsx)("span",{style:{fontSize:"16px"},children:"\u{1F39B}\uFE0F"}),children:["Remix ",ve[e.id]?"\u5F00":"\u5173"]},"".concat(e.id,":remix-toggle"));r.push(i)}return r},G=(0,a.jsxs)("div",{children:[(0,a.jsx)(Pa.Z,{}),(0,a.jsx)("div",{style:{marginTop:8},children:"Upload"})]}),at=function(e){return e.action==="DESCRIBE"?(0,a.jsxs)(a.Fragment,{children:[ye(e)," ",ma(e)," ",va(e.imageUrl,120)]}):e.action==="SHORTEN"?(0,a.jsxs)(a.Fragment,{children:[ye(e)," ",ma(e)]}):(0,a.jsxs)(a.Fragment,{children:[ye(e),e.action==="SWAP_VIDEO_FACE"?(0,a.jsx)(a.Fragment,{children:Kr(e.imageUrl,250)}):va(e.imageUrl,250)]})},rt=function(){return T==="INSIGHT_FACE"||T==="FACE_SWAP"?(0,a.jsxs)(L.Z,{vertical:!0,gap:8,children:[(0,a.jsx)(N.Z,j()(j()({},Sa),{},{listType:"picture-card",children:k.length>=1?null:G})),(0,a.jsx)(W.Z,{onChange:function(r){r.target.value&&_([{uid:"1",name:r.target.value,url:r.target.value}])},placeholder:l.formatMessage({id:"pages.draw.swap1Desc"})}),(0,a.jsx)(N.Z,j()(j()({},ba),{},{listType:"picture-card",children:U.length>=1?null:G})),(0,a.jsx)(W.Z,{onChange:function(r){r.target.value&&ee([{uid:"2",name:r.target.value,url:r.target.value}])},placeholder:l.formatMessage({id:"pages.draw.swap2Desc"})}),(0,a.jsx)(A.ZP,{style:{marginTop:"10px"},type:"primary",onClick:F,loading:J,children:l.formatMessage({id:"pages.draw.swapDesc"})})]}):T==="VIDEO_FACE_SWAP"?(0,a.jsxs)(L.Z,{vertical:!0,gap:8,children:[(0,a.jsx)(N.Z,j()(j()({},Sa),{},{listType:"picture-card",children:k.length>=1?null:G})),(0,a.jsx)(W.Z,{onChange:function(r){r.target.value&&_([{uid:"1",name:r.target.value,url:r.target.value}])},placeholder:l.formatMessage({id:"pages.draw.swap1Desc"})}),(0,a.jsx)(N.Z,j()(j()({},ba),{},{listType:"picture-card",children:U.length>=1?null:G})),(0,a.jsx)(W.Z,{onChange:function(r){r.target.value&&ee([{uid:"2",name:r.target.value,url:r.target.value}])},placeholder:l.formatMessage({id:"pages.draw.swap2VidelDesc"})}),(0,a.jsx)(A.ZP,{style:{marginTop:"10px"},type:"primary",onClick:F,loading:J,children:l.formatMessage({id:"pages.draw.swapVideoDesc"})})]}):C==="show"?(0,a.jsxs)(q.Z.Compact,{style:{width:"100%"},children:[(0,a.jsx)(W.Z,{placeholder:l.formatMessage({id:"pages.draw.inputIdShow"}),value:E,onChange:ue,onPressEnter:F}),(0,a.jsx)(A.ZP,{type:"primary",onClick:F,loading:J,children:l.formatMessage({id:"pages.draw.submitTask"})})]}):C==="showjobid"?(0,a.jsxs)(q.Z.Compact,{style:{width:"100%"},children:[(0,a.jsx)(W.Z,{placeholder:l.formatMessage({id:"pages.draw.inputJobIdShow"}),value:E,onChange:ue,onPressEnter:F}),(0,a.jsx)(A.ZP,{type:"primary",onClick:F,loading:J,children:l.formatMessage({id:"pages.draw.submitTask"})})]}):C==="imagine"?(0,a.jsxs)(L.Z,{vertical:!0,children:[(0,a.jsx)(N.Z,j()(j()({},Ie),{},{listType:"picture-card",children:O.length>=5?null:G})),(0,a.jsxs)(L.Z,{style:{width:"100%",marginTop:"10px"},gap:6,children:[(0,a.jsx)(ie,{placeholder:"Prompt",value:E,onChange:ue,onPressEnter:F,autoSize:{minRows:1,maxRows:12}}),(0,a.jsx)(A.ZP,{type:"primary",onClick:F,loading:J,children:l.formatMessage({id:"pages.draw.submitTask"})})]})]}):C==="blend"?(0,a.jsxs)(L.Z,{vertical:!0,children:[(0,a.jsx)(N.Z,j()(j()({},Ie),{},{listType:"picture-card",children:O.length>=5?null:G})),(0,a.jsxs)(q.Z,{style:{width:"100%",marginTop:"10px"},children:[(0,a.jsx)(Ae.ZP.Group,{value:Ne,onChange:Jr,options:[{value:"PORTRAIT",label:l.formatMessage({id:"pages.draw.PORTRAIT"})},{value:"SQUARE",label:l.formatMessage({id:"pages.draw.SQUARE"})},{value:"LANDSCAPE",label:l.formatMessage({id:"pages.draw.LANDSCAPE"})}],optionType:"button"}),(0,a.jsx)(A.ZP,{type:"primary",onClick:F,loading:J,children:l.formatMessage({id:"pages.draw.submitTask"})})]})]}):C==="describe"?(0,a.jsxs)(L.Z,{vertical:!0,children:[(0,a.jsx)(N.Z,j()(j()({},Ie),{},{listType:"picture-card",children:O.length>=1?null:G})),(0,a.jsx)(A.ZP,{style:{marginTop:"10px"},type:"primary",onClick:F,loading:J,children:l.formatMessage({id:"pages.draw.submitTask"})})]}):C==="shorten"?(0,a.jsxs)(L.Z,{style:{width:"100%",marginTop:"10px"},gap:6,children:[(0,a.jsx)(ie,{placeholder:"Prompt",value:E,onChange:ue,onPressEnter:F,autoSize:{minRows:1,maxRows:12}}),(0,a.jsx)(A.ZP,{type:"primary",onClick:F,loading:J,children:l.formatMessage({id:"pages.draw.submitTask"})})]}):(0,a.jsx)(a.Fragment,{})},ha=function(){var e=document.getElementById("canvas");e.width=e.clientWidth,e.height=e.clientHeight;var r=e.getContext("2d");r.fillStyle="blue"},tt=function(){return oe?me?(0,a.jsxs)(L.Z,{vertical:!0,children:[(0,a.jsx)(A.ZP,{style:{marginBottom:"10px"},icon:(0,a.jsx)(Me.Z,{}),onClick:ha,children:l.formatMessage({id:"pages.draw.clear"})}),(0,a.jsx)("canvas",{style:{backgroundImage:"url('".concat(oe,"')"),backgroundSize:"100% 100%"},id:"canvas",width:"550",height:sa}),(0,a.jsx)(ie,{style:{marginTop:"10px"},rows:2,value:le,onChange:fa})]}):(0,a.jsxs)(L.Z,{vertical:!0,children:[(0,a.jsx)(A.ZP,{style:{marginBottom:"10px"},icon:(0,a.jsx)(Me.Z,{}),onClick:ha,children:l.formatMessage({id:"pages.draw.clear"})}),(0,a.jsx)("canvas",{style:{backgroundImage:"url('".concat(oe,"')"),backgroundSize:"100% 100%"},id:"canvas",width:"550",height:sa})]}):(0,a.jsx)(ie,{rows:3,value:le,onChange:fa})};function je(n){n.onSuccess()}var Te=function(e){var r=e.type==="image/jpeg"||e.type==="image/png"||e.type==="video/mp4"||e.type==="image/webp";r||b.ZP.error(l.formatMessage({id:"pages.draw.onlyJpgPng"}));var i=e.size/1024/1024<10;return i||b.ZP.error(l.formatMessage({id:"pages.draw.limit10M"})),r&&i||N.Z.LIST_IGNORE},Ie={customRequest:je,beforeUpload:Te,fileList:O,onChange:function(e){V(e.fileList)},showUploadList:{showRemoveIcon:!0,showPreviewIcon:!1}},Sa={customRequest:je,beforeUpload:Te,maxCount:1,fileList:k,onChange:function(e){_(e.fileList)},showUploadList:{showRemoveIcon:!0,showPreviewIcon:!1}},ba={customRequest:je,beforeUpload:Te,maxCount:1,fileList:U,onChange:function(e){ee(e.fileList)},showUploadList:{showRemoveIcon:!0,showPreviewIcon:!1}},st=function(){var e,r=!1;T==="INSIGHT_FACE"||T==="FACE_SWAP"||T==="VIDEO_FACE_SWAP"?(r=!0,e=[{value:"swap",label:"/swap"}]):e=[{value:"imagine",label:"/imagine"},{value:"blend",label:"/blend"},{value:"describe",label:"/describe"},{value:"shorten",label:"/shorten"},{value:"showjobid",label:"/show job_id"},{value:"show",label:"/show task_id"}];var i=ua.map(function(s){return{value:s.channelId,label:s.channelId+" - "+(s.remark||""),disabled:!s.enable||!s.running}});return(0,a.jsxs)(q.Z,{style:{marginBottom:"10px"},children:[(0,a.jsx)(de.Z,{value:r?"swap":C,style:{width:150},onChange:Or,options:e}),(0,a.jsx)(de.Z,{value:pe,onChange:Wr,style:{width:120},options:[{label:l.formatMessage({id:"pages.draw.speedMode.relax"}),value:"relax"},{label:l.formatMessage({id:"pages.draw.speedMode.fast"}),value:"fast"},{label:l.formatMessage({id:"pages.draw.speedMode.turbo"}),value:"turbo"}]}),(0,a.jsx)(Ae.ZP.Group,{value:T,onChange:Nr,options:[{value:"MID_JOURNEY",label:"Midjourney"},{value:"NIJI_JOURNEY",label:"niji\u30FBjourney"},{value:"FACE_SWAP",label:"FaceSwap"},{value:"VIDEO_FACE_SWAP",label:"Video\u30FBFaceSwap"}],optionType:"button"}),(0,a.jsx)(de.Z,{value:Er,style:{width:320,display:"none"},onChange:Dr,options:i,allowClear:!0,placeholder:l.formatMessage({id:"pages.draw.selectAccount"})})]})};return(0,a.jsxs)(Aa._z,{children:[Ja,(0,a.jsx)(ne.Z,{style:{marginBottom:"15px",overflow:"auto",height:"70vh"},loading:Ga,id:"task-panel",children:Qr()}),(0,a.jsxs)(ne.Z,{children:[st(),rt()]}),(0,a.jsx)(Ba.Z,{title:mr,open:gr,onCancel:Gr,onOk:zr,confirmLoading:xr,width:600,children:tt()})]})},Da=Oa}}]);
